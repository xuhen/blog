<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="keyword"  content="">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        javascript decorators 它们是什么，使用场景 - undefined
        
    </title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/aircloud.css">
    <link rel="stylesheet" href="/css/gitment.css">
    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>
</head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i>  </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar">
            <img src="https://dn-coding-net-production-static.qbox.me/static/7a51352fa766f4176d7c4543339e0e98.png" />
        </div>
        <div class="name">
            <i>Edward xu</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li >
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>主页</span>
                </a>
            </li>
            <li >
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>标签</span>
                </a>
            </li>
            <li >
                <a href="/archives">
                    <i class="iconfont icon-guidang2"></i>
                    <span>存档</span>
                </a>
            </li>
            <li >
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>关于</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#装饰器是啥呢？"><span class="toc-text">装饰器是啥呢？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#怎样使用javascript装饰器呢？"><span class="toc-text">怎样使用javascript装饰器呢？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#为啥使用装饰器呢？"><span class="toc-text">为啥使用装饰器呢？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#不同类型的装饰器"><span class="toc-text">不同类型的装饰器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#类的成员装饰器"><span class="toc-text">类的成员装饰器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#类装饰器"><span class="toc-text">类装饰器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#结束语"><span class="toc-text">结束语</span></a></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input"/>
            <span id="begin-search">搜索</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>
        <div class="index-about-mobile">
            <i>  </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        javascript decorators 它们是什么，使用场景
    </div>

    <div class="post-meta">
        <span class="attr">发布于：<span>2018-10-05 21:26:49</span></span>
        
        </span>
        <span class="attr">访问：<span id="busuanzi_value_page_pv"></span>
</span>
</span>
    </div>
    <div class="post-content ">
        <p>随着 ES2015+ 的完善，还有编译器的广泛使用，许多人都会在项目代码或教程片段中遇到一些ES语言的新特性。当JS程序员第一次遇到这些特性中的一个（decorators）都会发蒙，这是什么语法呢？</p>
<p>说起装饰器能在ES中流行得多亏了Angular2+，那在Angular中能用装饰器，又得多亏了TypeScript, 因为在ES目前的版本中，这个特性正处在<a href="https://github.com/tc39/proposals#stage-2" target="_blank" rel="noopener">stage 2 proposal</a> 的阶段，那这也意味着这个特性是以后才会加到ES的稳定版本的。那让我们言归正传看下装饰器是啥东东，它怎样使我们的代码更整洁，和易懂的。</p>
<h3 id="装饰器是啥呢？"><a href="#装饰器是啥呢？" class="headerlink" title="装饰器是啥呢？"></a>装饰器是啥呢？</h3><p>简单的理解，装饰器就是包裹一段代码在一个函数中–也就是字面意思‘修饰’它。这个思想可能之前你接触‘函数组合’，或者高阶函数时比较熟悉。</p>
<p>用一个函数去包裹另一个函数，在目前的ES中已有广泛的应用了。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doSomething</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'Hello, '</span> + name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loggingDecorator</span>(<span class="params">wrapped</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Starting'</span>);</span><br><span class="line">    <span class="keyword">const</span> result = wrapped.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Finished'</span>);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> wrapped = loggingDecorator(doSomething);</span><br></pre></td></tr></table></figure>
<p>上面的例子只是产生了一个新函数–在变量<code>wrapped</code>中。这个新函数可以像调用<code>doSomething</code>一样，它俩都干一样的事。它们的区别是新函数的调用会输出一些logging日志。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">doSomething(<span class="string">'Graham'</span>);</span><br><span class="line"><span class="comment">// Hello, Graham</span></span><br><span class="line"></span><br><span class="line">wrapped(<span class="string">'Graham'</span>);</span><br><span class="line"><span class="comment">// Starting</span></span><br><span class="line"><span class="comment">// Hello, Graham</span></span><br><span class="line"><span class="comment">// Finished</span></span><br></pre></td></tr></table></figure>
<h3 id="怎样使用javascript装饰器呢？"><a href="#怎样使用javascript装饰器呢？" class="headerlink" title="怎样使用javascript装饰器呢？"></a>怎样使用javascript装饰器呢？</h3><p>在JS中装饰器用了一种特殊的语法，那就是用@符合作为前缀，并且放在所有装饰的代码前面。</p>
<p>在同一个代码片段上，你爱用多少个装饰器都可以，并且都会安你声明的顺序起作用。</p>
<p>比如下面的例子：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@log()</span><br><span class="line">@immutable()</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Example</span> </span>&#123;</span><br><span class="line">  @time(<span class="string">'demo'</span>)</span><br><span class="line">  doSomething() &#123;</span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个例子定义了一个类，并且声明了三个装饰器–两个是类的，还有一个是类的属性的。</p>
<ul>
<li><code>@log</code> 可能输出类的所用日志</li>
<li><code>@immutable</code> 可能让类保持不可串改– 或许对实例使用了 <code>Object.freeze</code></li>
<li><code>@time</code> 将记录一个方法执行的花费的时间，并用一个唯一的标签以日志的方式输出。</li>
</ul>
<p>目前来看，要用装饰器的话得用编译器（babel），因为目前的浏览器和Node最新版本还没支持这个新特性。如果你用babel的话用<a href="https://github.com/loganfsmyth/babel-plugin-transform-decorators-legacy" target="_blank" rel="noopener"> transform-decorators-legacy plugin</a>插件就能支持。</p>
<h3 id="为啥使用装饰器呢？"><a href="#为啥使用装饰器呢？" class="headerlink" title="为啥使用装饰器呢？"></a>为啥使用装饰器呢？</h3><p>目前函数组合已经在Javascript广泛使用，把同样的技巧运用给其他代码（比如：类和类的属性）是非常困难或者说不可能的。</p>
<p>装饰器也运用更优雅的方式去包装你的代码，结果就是让你更集中于你的业务代码，不被冗长的包装代码分心。</p>
<h3 id="不同类型的装饰器"><a href="#不同类型的装饰器" class="headerlink" title="不同类型的装饰器"></a>不同类型的装饰器</h3><p>目前，只有类和类的成员才能用装饰器。这些成员有 properties, methods, getters, and setters</p>
<p>装饰器其实就是返回包装函数的函数而已，返回的函数被精心装饰了下。这些装饰器函数在程序第一次执行时被算值一次。被装饰的代码被返回值替换掉。</p>
<h3 id="类的成员装饰器"><a href="#类的成员装饰器" class="headerlink" title="类的成员装饰器"></a>类的成员装饰器</h3><p>属性装饰器只作用于类的单个成员–也就是properties, methods, getters, 和 setters。这个装饰器函数用三个参数去执行。</p>
<ul>
<li><code>target</code> 成员所在的目标类</li>
<li><code>name</code> 此成员在类上的名字</li>
<li><code>descriptor</code> 成员描述，这是传给 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty" target="_blank" rel="noopener">Object.defineProperty</a> 方法的对象</li>
</ul>
<p>经典的例子就是<code>@readonly</code>装饰器。下面是它的简单实现：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">readonly</span>(<span class="params">target, name, descriptor</span>) </span>&#123;</span><br><span class="line">  descriptor.writable = <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">return</span> descriptor;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面的例子其实就是把描述对象的<code>writable</code>属性设置为<code>false</code></p>
<p>下面是使用readonly的例子</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Example</span> </span>&#123;</span><br><span class="line">  a() &#123;&#125;</span><br><span class="line">  @readonly</span><br><span class="line">  b() &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> e = <span class="keyword">new</span> Example();</span><br><span class="line">e.a = <span class="number">1</span>;</span><br><span class="line">e.b = <span class="number">2</span>;</span><br><span class="line"><span class="comment">// TypeError: Cannot assign to read only property 'b' of object '#&lt;Example&gt;'</span></span><br></pre></td></tr></table></figure>
<p>我们能丰富下上面的例子。我们能让这个装饰器有不一样的行为。比如输出所有的输入输出日志。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params">target, name, descriptor</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> original = descriptor.value;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> original === <span class="string">'function'</span>) &#123;</span><br><span class="line">    descriptor.value = <span class="function"><span class="keyword">function</span>(<span class="params">...args</span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">`Arguments: <span class="subst">$&#123;args&#125;</span>`</span>);</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> result = original.apply(<span class="keyword">this</span>, args);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`Result: <span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`Error: <span class="subst">$&#123;e&#125;</span>`</span>);</span><br><span class="line">        <span class="keyword">throw</span> e;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> descriptor;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面的例子用新的方法替换了旧的并输出了arguments参数，调用旧方法，和输出日志。</p>
<p>注意，上面的例子我们用了<a href="https://www.sitepoint.com/es6-destructuring-assignment/" target="_blank" rel="noopener">spread operator</a>操作符，<br>去参数里取到数组，这也是比<code>arguments</code>的方式更时髦的选择。</p>
<p>我们也看下如何使用：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Example</span> </span>&#123;</span><br><span class="line">  @log</span><br><span class="line">  sum(a, b) &#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> e = <span class="keyword">new</span> Example();</span><br><span class="line">e.sum(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line"><span class="comment">// Arguments: 1,2</span></span><br><span class="line"><span class="comment">// Result: 3</span></span><br></pre></td></tr></table></figure>
<p>你或许注意到了，我们必须用晦涩的语法去执行这段被装饰的方法。简单说来<code>apply</code>函数让我们在<code>this</code>作用域上调用旧函数，并且传入参数。</p>
<p>更进一步，我们能让装饰器接收一些参数，比如下面这样重写下<code>log</code>装饰器：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">decorator</span>(<span class="params">t, n, descriptor</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> original = descriptor.value;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> original === <span class="string">'function'</span>) &#123;</span><br><span class="line">      descriptor.value = <span class="function"><span class="keyword">function</span>(<span class="params">...args</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`Arguments for <span class="subst">$&#123;name&#125;</span>: <span class="subst">$&#123;args&#125;</span>`</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="keyword">const</span> result = original.apply(<span class="keyword">this</span>, args);</span><br><span class="line">          <span class="built_in">console</span>.log(<span class="string">`Result from <span class="subst">$&#123;name&#125;</span>: <span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">          <span class="keyword">return</span> result;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(<span class="string">`Error from <span class="subst">$&#123;name&#125;</span>: <span class="subst">$&#123;e&#125;</span>`</span>);</span><br><span class="line">          <span class="keyword">throw</span> e;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> descriptor;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个例子变得有点复杂了，让我们仔细看会得到下面的结论：</p>
<ul>
<li><code>log</code>  函数接收唯一的一个参数：<code>name</code></li>
<li>这个函数然后返回一个本身是装饰器的函数</li>
</ul>
<p>这个log装饰器，除了使用最外层的参数<code>name</code>之外几乎等同于之前的那个 <code>log</code>装饰器。</p>
<p>下面是复杂<code>log</code>的使用：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Example</span> </span>&#123;</span><br><span class="line">  @log(<span class="string">'some tag'</span>)</span><br><span class="line">  sum(a, b) &#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> e = <span class="keyword">new</span> Example();</span><br><span class="line">e.sum(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line"><span class="comment">// Arguments for some tag: 1,2</span></span><br><span class="line"><span class="comment">// Result from some tag: 3</span></span><br></pre></td></tr></table></figure>
<p>很明显，我们能用自己提供的 tag去区分不同的日志输出。</p>
<p>上面的代码能工作，是因为 <code>log(&#39;some tag&#39;)</code> 函数是被JavaScript runtime立即执行的<br>返回值作为<code>sum</code>方法的装饰器。</p>
<h3 id="类装饰器"><a href="#类装饰器" class="headerlink" title="类装饰器"></a>类装饰器</h3><p>类装饰器是在整个类定义时一并起作用的。这个装饰器函数的参数只有一个，即被装饰的 <code>constructor</code> 函数。</p>
<p>注意，这是作用于 <code>constructor</code> 函数的，而不是基于类创建的实例。这就意味着如果你想操纵实例，你必须返回一个被包裹的 <code>constructor</code> 版本。</p>
<p>总的来说，这种用法比起类成员装饰器来比较少用到，因为能用这种方式实现的事，也能用一个简单的函数调用实现。<br>如果你实在需要用到，你需要返回一个新 <code>constructor</code> 函数去换掉类 <code>constructor</code>.</p>
<p>回到我们的日志函数例子，让我们打印下，<code>constructor</code> 的参数。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params">Class</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">...args</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(args);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Class(...args);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里我们接受一个类作为参数，并且返回了新的函数作为 <code>constructor</code>。<br>这只是简单的打印了下参数，返回了旧 <code>constructor</code> 的实例。</p>
<p>如下调用：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@log</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Example</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(name, age) &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> e = <span class="keyword">new</span> Example(<span class="string">'Graham'</span>, <span class="number">34</span>);</span><br><span class="line"><span class="comment">// [ 'Graham', 34 ]</span></span><br><span class="line"><span class="built_in">console</span>.log(e);</span><br><span class="line"><span class="comment">// Example &#123;&#125;</span></span><br></pre></td></tr></table></figure>
<p>我们能看到构造的 <code>Example</code> 类打印了提供的参数日志，构造的 <code>value</code> 也<br>确实是 <code>Example</code> 的实例。正如我们要的一样。</p>
<p>向类装饰器传参，就像类成员传参一样：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">decorator</span>(<span class="params">Class</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">...args</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">`Arguments for <span class="subst">$&#123;name&#125;</span>: args`</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> Class(...args);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@log(<span class="string">'Demo'</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Example</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(name, age) &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> e = <span class="keyword">new</span> Example(<span class="string">'Graham'</span>, <span class="number">34</span>);</span><br><span class="line"><span class="comment">// Arguments for Demo: args</span></span><br><span class="line"><span class="built_in">console</span>.log(e);</span><br><span class="line"><span class="comment">// Example &#123;&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="结束语"><a href="#结束语" class="headerlink" title="结束语"></a>结束语</h3><p>类成员装饰器提供了包装一段在类中的代码的好方法。就像我们包装函数到另一个函数一样。这样我们就能写些<br>帮助代码复用在许多地方，这样的代码既优雅，也易懂。</p>
<p>翻译 <a href="https://www.sitepoint.com/javascript-decorators-what-they-are/" target="_blank" rel="noopener">JavaScript Decorators: What They Are and When to Use Them</a></p>

        
        <div id="comment-container">
        </div>
    </div>
</div>
    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        

        

        

        

        

    </ul>
    
    <p>
        <span id="busuanzi_container_site_pv">
            <span id="busuanzi_value_site_pv"></span>PV
        </span>
        <span id="busuanzi_container_site_uv">
            <span id="busuanzi_value_site_uv"></span>UV
        </span>
        Created By <a href="https://hexo.io/">Hexo</a>  Theme <a href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a></p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = ""
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="/js/index.js"></script>
<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

</html>
